{% extends "base-clean.html" %}

{% block extra_head %}
<link rel="stylesheet" href="/theme/photoswipe/photoswipe.css">
{% endblock extra_head %}

{% block extra_body %}
<script src="/theme/isotope.pkgd.min.js"></script>
<script src="/theme/imagesloaded.pkgd.min.js"></script>
<script>
var elem = document.querySelector('.grid');
var iso = new Isotope(elem, {
    itemSelector: '.grid-item',
    percentPosition: true,
    masonry: {
        columnWidth: '.grid-sizer'
    }
});
imagesLoaded(elem).on('progress', function() {
    iso.layout();
});
</script>
<script type="module">
import PhotoSwipeLightBox from '/theme/photoswipe/photoswipe-lightbox.esm.min.js';
const lightbox = new PhotoSwipeLightBox({
    gallery: '#the-gallery',
    children: 'a',
    showHideAnimationType: 'fade',
    pswpModule: () => import('/theme/photoswipe/photoswipe.esm.min.js')
});
lightbox.init();
</script>
{% endblock extra_body %}

{% block title %}{{ page.title }} - {{ SITENAME }}{% endblock %}
{% block profile_span %}{% endblock %}
{% block content_span %}
<div class='gallery'>
    <div class="row-fluid">
        <div class="content-title-gallery span9">
            <h1>{{ page.title }}</h1>
        </div>
    </div>
    <div class="row-fluid">
        {{ page.content }}

        {% if page.gallery_id %}
        <div class="grid" id="the-gallery">
            <div class="grid-sizer"></div>

            {% set images = get_gallery_images(page.gallery_id) %}
            {% set is_wide = false %}

            {% for img in images %}
            <div class="grid-item{% if is_wide %} grid-item-wide{% endif %}">
                <a href="/images/gallery/{{ page.gallery_id }}/{{ img.name }}.avif"
                   data-pswp-width="{{ img.width }}"
                   data-pswp-height="{{ img.height }}"
                   target="_blank">
                    <img src="/images/gallery/{{ page.gallery_id }}/thumbnails/{{ img.name }}.jpg" alt="">
                </a>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
