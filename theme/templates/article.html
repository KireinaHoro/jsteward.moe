{% extends "base.html" %}

{% block title %}{{ article.title|striptags }} - {{ SITENAME }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="/theme/photoswipe/photoswipe.css">
{% endblock extra_head %}

{% block extra_body %}
<script type="module">
import PhotoSwipeLightBox from '/theme/photoswipe/photoswipe-lightbox.esm.min.js';
const lightbox = new PhotoSwipeLightBox({
    gallery: '#the-gallery',
    children: 'a',
    showHideAnimationType: 'fade',
    pswpModule: () => import('/theme/photoswipe/photoswipe.esm.min.js')
});
lightbox.on('uiRegister', function() {
    lightbox.pswp.ui.registerElement({
        name: 'custom-caption',
        order: 9,
        isButton: false,
        appendTo: 'root',
        html: 'Caption text',
        onInit: (el, pswp) => {
            lightbox.pswp.on('change', () => {
                const currSlideElement = lightbox.pswp.currSlide.data.element;
                let captionHTML = '';
                if (currSlideElement) {
                // get caption from alt attribute
                    captionHTML = currSlideElement.querySelector('img').getAttribute('alt');
                }
                el.innerHTML = captionHTML || '';
            });
        }
    });
});
lightbox.init();
</script>
{% endblock extra_body %}

{% block content %}
<div class='article'>
    <div class="row-fluid">
        <div class="content-title span9">
            <h1>{{ article.title }}</h1>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span2">
            {% include "article-sidebar.html" %}
        </div>

        <div class="span10" id="the-gallery">
            {{ article.content }}
            <hr />
        </div>
    </div>
    <div class="row-fluid">
        <div class="span2"></div>
        <div class="span10">
            <h3>Comments</h3>

            {% include 'disqus.html' %}
        </div>
    </div>
</div>
{% endblock %}
